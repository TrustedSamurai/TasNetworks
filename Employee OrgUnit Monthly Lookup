DO BEGIN 
DECLARE lv_fromdate DATE = '20170701';
DECLARE lv_todate DATE = '20300731';
DECLARE LV_EMPLOYEE TABLE(EMPLOYEE NVARCHAR(8), HRPOSITION NVARCHAR(8), ORGUNIT NVARCHAR(8), REPORTDATE DATE);
WHILE :lv_fromdate< :lv_todate DO  
      INSERT INTO :LV_EMPLOYEE (EMPLOYEE, HRPOSITION, ORGUNIT, REPORTDATE )
      SELECT EMPLOYEE, HRPOSITION, ORGUNIT, :lv_fromdate FROM EHS_DA_DMART."EmployeeLimitedvw" e
      WHERE e."DATETO" >= :lv_fromdate and e."DATEFROM" <= :lv_fromdate 
      AND e.EMPLGROUP <>'F' and e.EMPLPCT <> 0;
      lv_fromdate = ADD_Months(:lv_fromdate,1);    
END WHILE;
SELECT EMPLOYEE, HRPOSITION, ORGUNIT, REPORTDATE  FROM :LV_EMPLOYEE
ORDER BY EMPLOYEE, REPORTDATE;
END
